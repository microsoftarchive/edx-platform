## -*- coding: utf-8 -*-
<%! from django.utils.translation import ugettext as _ %>
<%! from django.template.defaultfilters import escapejs %>
<%namespace name='static' file='static_content.html'/>

<!doctype html>
<!--[if IE 7]><html class="ie7 lte9 lte8 lte7" lang="${LANGUAGE_CODE}"><![endif]-->
<!--[if IE 8]><html class="ie8 lte9 lte8" lang="${LANGUAGE_CODE}"><![endif]-->
<!--[if IE 9]><html class="ie9 lte9" lang="${LANGUAGE_CODE}"><![endif]-->
<!--[if gt IE 9]><!--><html lang="${LANGUAGE_CODE}"><!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>
        <%block name="title"></%block> |
        % if context_course:
        <% ctx_loc = context_course.location %>
        ${context_course.display_name_with_default | h} |
        % endif
        edX Studio
    </title>

    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="path_prefix" content="${EDX_ROOT_URL}">

    <%static:css group='style-vendor'/>
    <%static:css group='style-vendor-tinymce-content'/>
    <%static:css group='style-vendor-tinymce-skin'/>
    <%static:css group='style-app'/>
    <%static:css group='style-app-extend1'/>
    <%static:css group='style-xmodule'/>

    <%include file="widgets/segment-io.html" />

    <%block name="header_extras"></%block>
  </head>

  <body class="<%block name='bodyclass'></%block> hide-wip lang_${LANGUAGE_CODE}">
  <%block name="view_notes"></%block>

    <a class="nav-skip" href="#content">${_("Skip to this view's content")}</a>

    <script type="text/javascript">
        window.baseUrl = "${settings.STATIC_URL}";
        var require = {
            baseUrl: baseUrl,
            paths: {
              "gettext": "/i18n",
              "xmodule": "/xmodule/xmodule",
             // externally hosted files
              "tender": [
                "//edxedge.tenderapp.com/tender_widget",
                // if tender fails to load, fallback on a local file
                // so that require doesn't fall over
                "js/src/tender_fallback"
              ],
              "mathjax": "//edx-static.s3.amazonaws.com/mathjax-MathJax-727332c/MathJax.js?config=TeX-MML-AM_HTMLorMML-full&delayStartupUntil=configured",
              "youtube": [
                // youtube URL does not end in ".js". We add "?noext" to the path so
                // that require.js adds the ".js" to the query component of the URL,
                // and leaves the path component intact.
                "//www.youtube.com/player_api?noext",
                // if youtube fails to load, fallback on a local file
                // so that require doesn't fall over
                "js/src/youtube_fallback"
              ]
            },
            map: {
              "*": {
                "coffee/src/ajax_prefix": "xmodule_js/common_static/coffee/src/ajax_prefix",
                "coffee/src/logger": "xmodule_js/common_static/coffee/src/logger",
                "xblock/cms.runtime.v1": "coffee/src/xblock/cms.runtime.v1",
                "xblock/core": "xmodule_js/common_static/coffee/src/xblock/core",
                "jquery.immediateDescendents": "xmodule_js/common_static/coffee/src/jquery.immediateDescendents",
              }
            },
            shim: {
              "gettext": {
                  exports: "gettext"
              },
              "tender": {
                exports: 'Tender'
              },
              "youtube": {
                exports: "YT"
              },
              "mathjax": {
                exports: "MathJax",
                init: function() {
                  MathJax.Hub.Config({
                    tex2jax: {
                      inlineMath: [
                        ["\\(","\\)"],
                        ['[mathjaxinline]','[/mathjaxinline]']
                      ],
                      displayMath: [
                        ["\\[","\\]"],
                        ['[mathjax]','[/mathjax]']
                      ]
                    }
                  });
                  MathJax.Hub.Configured();
                }
              }
            }
        };
    </script>
    <script type="text/javascript" data-main="js/require_pages/base" src="${static.url("js/vendor/require.js")}"></script>

    ## js templates
    <script id="system-feedback-tpl" type="text/template">
      <%static:include path="js/system-feedback.underscore" />
    </script>

    % if context_course:
        <script type="text/javascript">
        require(['js/require_pages/base',], function () {
            require(['js/require_pages/course'], function(Course) {
                Course({
                  id: "${context_course.id | escapejs}",
                  name: "${context_course.display_name_with_default | h}",
                  url_name: "${context_course.location.name | h}",
                  org: "${context_course.location.org | h}",
                  num: "${context_course.location.course | h}",
                  revision: "${context_course.location.revision | h}"
                });
            });
        });
        </script>
    % endif

    <!-- view -->
    <div class="wrapper wrapper-view">
        <% online_help_token = self.online_help_token() if hasattr(self, 'online_help_token') else None %>
        <%include file="widgets/header.html" args="online_help_token=online_help_token" />

      <div id="page-alert">
      <%block name="page_alert"></%block>
      </div>

      <div id="content">
      <%block name="content"></%block>
      </div>

      % if user.is_authenticated():
      <script type="text/javascript">
        require(['js/require_pages/base'], function () {
            require(['js/sock']);
        });
      </script>
      <%include file="widgets/sock.html" args="online_help_token=online_help_token" />
      % endif

      <%include file="widgets/footer.html" />
      <%include file="widgets/tender.html" />

      <div id="page-notification"></div>
    </div>

    <div id="page-prompt"></div>
    <%block name="jsextra"></%block>
    <div class="modal-cover"></div>
  </body>
</html>
